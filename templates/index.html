<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flask App</title>
    <!-- Bootstrap CSS (Updated to Bootstrap 5) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>
    <div class="container mt-5">
        <h1 class="mb-4">Titanic Machine Learning App</h1>

        <div class="row">
            <div class="col-md-6 mb-3">
                <fieldset>
                    <legend>Select Gender ‚ö§:</legend>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="male" name="gender" value="0" checked />
                        <label class="form-check-label" for="male">üë® Male</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="female" name="gender" value="1" />
                        <label class="form-check-label" for="female">üëß Female</label>
                    </div>
                </fieldset>
            </div>

            <div class="col-md-6 mb-3">
                <fieldset>
                    <legend>Select your title:</legend>
                    <!-- Titles -->
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="mr" name="title" value="1" checked />
                        <label class="form-check-label" for="mr">üßë‚Äç‚öñÔ∏è Mr - Adult male</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="miss" name="title" value="2" />
                        <label class="form-check-label" for="miss">üë© Miss - Unmarried woman or girl</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="mrs" name="title" value="3" />
                        <label class="form-check-label" for="mrs">üíç Mrs - Married woman</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="master" name="title" value="4" />
                        <label class="form-check-label" for="master">üë¶ Master - Boys and young men</label>
                    </div>
                </fieldset>
            </div>

            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <legend for="Parch" class="form-label">
                        Select number of parents/Children:
                    </legend>
                    <select id="Parch" name="Parch" class="form-select">
                        <option value="0" selected>0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="9">9</option>
                    </select>
                </div>
            </div>

            <div class="col-md-6 mb-3">
                <fieldset>
                    <legend>Select port of embarkation:</legend>
                    <!-- Ports -->
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="cherbourg" name="embarked" value="1" checked />
                        <label class="form-check-label" for="cherbourg">üö¢ Cherbourg</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="queenstown" name="embarked" value="2" />
                        <label class="form-check-label" for="queenstown">üö¢ Queenstown</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="southampton" name="embarked" value="0" />
                        <label class="form-check-label" for="southampton">üö¢ Southampton</label>
                    </div>
                </fieldset>
            </div>

            <div class="col-md-6 mb-3">
                <fieldset>
                    <legend>Select passenger class:</legend>
                    <!-- Classes -->
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="first_class" name="pclass" value="1" checked />
                        <label class="form-check-label" for="first_class">ü•á 1st class (Upper)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="second_class" name="pclass" value="2" />
                        <label class="form-check-label" for="second_class">ü•à 2nd class (Middle)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="third_class" name="pclass" value="3" />
                        <label class="form-check-label" for="third_class">ü•â 3rd class (Lower)</label>
                    </div>
                </fieldset>
            </div>

            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <!-- Encapsulating in a form-group for better spacing and alignment -->
                    <legend for="sibsp" class="form-label">
                        Select number of siblings/spouses:
                    </legend>
                    <!-- Using form-label for consistency -->
                    <select id="sibsp" name="sibsp" class="form-select">
                        <!-- Changed to form-select for Bootstrap 5, if you're using Bootstrap 4, keep it as form-control -->
                        <option value="0" selected>0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="8">8</option>
                    </select>
                </div>
            </div>

            <div class="col-md-6 mb-3">
                <legend>How old are you?</legend>
                <div class="form-check">
                    <input class="form-check-input" type="radio" id="children" name="age" value="0" checked />
                    <label class="form-check-label" for="children">üßí Children</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" id="teen" name="age" value="1" />
                    <label class="form-check-label" for="teen">üë¶ Teen</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" id="young_adult" name="age" value="2" />
                    <label class="form-check-label" for="young_adult">üßë Young Adult</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" id="adult" name="age" value="3" />
                    <label class="form-check-label" for="adult">üßì Adult</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" id="senior" name="age" value="4" />
                    <label class="form-check-label" for="senior">üë¥ Senior</label>
                </div>
            </div>

            <div class="col-md-6 mb-3">
                <legend>How much did you pay for your ticket:</legend>
                <select class="form-select" id="amountSelect">
                    {% for i in range(0, 500, 100) %}
                    <option value="{{ i }}">{{ i }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-6 mb-3">
                <fieldset>
                    <legend>Do You Have Any Relatives With You?</legend>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="relativesYes" name="relatives" value="1" />
                        <label class="form-check-label" for="relativesYes">üëç Yes</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" id="relativesNo" name="relatives" value="0"
                            checked />
                        <label class="form-check-label" for="relativesNo">üëé No</label>
                    </div>
                </fieldset>
            </div>

            <div class="col-md-6 mb-3"> <!-- Changed to col-md-12 for full width -->
                <h4 id="survivalText">The chance of surviving the Titanic is <span id="sur_per">0</span>%</h4> <!-- Text element to display the percentage -->
                <div class="progress" style="width: 100%;"> <!-- Make the progress container full width -->
                    <div class="progress-bar" role="progressbar" style="width: 0%;" id="percentageBar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                </div>
                
            </div>
        

            <div class="col-12 mt-4">
                <button id="submitBtn" class="btn btn-primary">Submit</button>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
            $("#submitBtn").click(function (e) {
                e.preventDefault();

                var formData = {
                    Sex: parseFloat($('input[name="gender"]:checked').val()),
                    Title: parseFloat($('input[name="title"]:checked').val()),
                    Parch: parseFloat($("#Parch").val()),
                    Embarked: parseFloat($('input[name="embarked"]:checked').val()),
                    Pclass: parseFloat($('input[name="pclass"]:checked').val()),
                    SibSp: parseFloat($("#sibsp").val()),
                    AgeGroup: parseFloat($('input[name="age"]:checked').val()),
                    Fare: parseFloat($("#amountSelect").val()),
                    Relative: parseFloat($('input[name="relatives"]:checked').val())
                };

                console.log(formData); // This will log the JSON object to the console.

                $.ajax({
                    type: 'POST',
                    url: '/infer',  // Adjust the URL if necessary
                    contentType: 'application/json',  // Set the content type to JSON
                    data: JSON.stringify(formData),  // Convert formData object to JSON string
                    success: function (response) {
                        console.log('Response:', response.predictions); 

                        
                        var percentage = response.predictions * 100 
                        $("#sur_per").text(percentage)
                        let bar = $('#percentageBar');
                        bar.width(percentage + '%');
                        bar.text(percentage + '%');
                        bar.attr('aria-valuenow', percentage);

                        // Remove any existing background classes
                        bar.removeClass('bg-success bg-info bg-warning bg-danger');

                        if (percentage < 25) {
                            bar.addClass('bg-danger');
                        } else if (percentage < 50) {
                            bar.addClass('bg-warning');
                        } else if (percentage < 75) {
                            bar.addClass('bg-info');
                        } else {
                            bar.addClass('bg-success');
                        }
                    },
                    error: function (error) {
                        console.error('Error:', error);
                        // Handle errors here
                    }
                });




            });
        });
    </script>
</body>

</html>